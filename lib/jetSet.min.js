function t(t){return"function"==typeof t?t():t}function e(){return n.create({snapshot:{},watchers:{},on:function(e,n){let r=this,s=r.watchers;s[e]=s[e]||[],s[e].push(n),r.snapshot[e]=t(r[e])},off:function(t,e){let n=this.watchers;n[t]=n[t].filter(t=>t!==e)}})}let n=Object;module.exports=function(r){let s=e();return n.assign(s,r),new Proxy(s,{set:(e,n,r)=>{let s=e.watchers,o=e.snapshot;e[n]=r;for(let n in s){let r=o[n],c=t(e[n]),u=s[n];c!==r&&(u.map(t=>t(c,r)),o[n]=c)}return!0},get:(e,n)=>e.hasOwnProperty(n)?t(e[n]):e[n]})};