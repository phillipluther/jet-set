let t=Object,e=t=>"function"==typeof t?t():t,n=()=>t.create({snapshot:{},watchers:{},onChange:function(t,n){let s=this,r=s.watchers;r[t]=r[t]||[],r[t].push(n),s.snapshot[t]=e(s[t])},offChange:function(t,e){let n=this.watchers;n[t]=n[t].filter(t=>t!==e)}});module.exports=(s=>{let r=n();return t.assign(r,s),new Proxy(r,{set:(t,n,s)=>{let{watchers:r,snapshot:o}=t;t[n]=s;for(let n in r){let s=o[n],a=e(t[n]),h=r[n];a!==s&&(h.map(t=>t(a,s)),o[n]=a)}return!0},get:(t,n)=>t.hasOwnProperty(n)?e(t[n]):t[n]})});