function t(t){return"function"==typeof t?t():t}function n(n){function e(){for(let t in n)this[t]=n[t]}let o={watchers:{},snapshot:{},on:function(n,e){let o=this,r=o.watchers;r[n]=r[n]||[],r[n].push(e),o.snapshot[n]=t(o[n])},off:function(t,n){let e=this.watchers;e[t]=e[t].filter(t=>t!==n)}};for(let t in o)e.prototype[t]=o[t];return new e}module.exports=function(e){let o=n(e);return new Proxy(o,{set:(n,e,o)=>{n[e]=o;let r=n.watchers;for(let e in r){let o=t(n[e]),s=r[e],f=n.snapshot[e];o!==f&&(s.map(t=>t(o,f)),n.snapshot[e]=o)}return!0},get:(n,e)=>n.hasOwnProperty(e)?t(n[e]):n[e]})};